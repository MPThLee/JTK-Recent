name: Manual Re-Deploy from GH-Pages data

on:
  workflow_dispatch:

jobs:
  deploy:
    name: Deploy by commit trigger.
    runs-on: ubuntu-latest
    if: "!contains(github.event.head_commit.author.name, 'dependabot')" # ignore dependabot
    steps:
      - uses: volta-cli/action@v1.7.0
      - name: Install Surge via volta
        run: volta install surge

      - name: Checkout gh-pages branch
        uses: actions/checkout@v2.3.4
        with:
          ref: 'gh-pages'
          path: dist

      - name: Deploy to surge.sh (Prod)
        uses: dswistowski/surge-sh-action@v1.0.1
        with:
          domain: '${{ secrets.surge_domain }}'
          project: './dist'
          login: ${{ secrets.surge_login }}
          token: ${{ secrets.surge_token }}